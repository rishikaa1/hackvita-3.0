<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RoadCraft</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" 
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/style.css"> 
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light sticky-top">
        <div class="container-fluid">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" 
                    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item"><a class="nav-link" href="#home">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="#id-simul">Simulator</a></li>
                    <li class="nav-item"><a class="nav-link" href="#id-about">About</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <section class="gradient" id="home">
        <div class="container-fluid">
            <div class="brand">
                <h1>RoadCraft</h1>
                <p>A Comprehensive Solution for Road Detection</p>
            </div>
            <div class="new-container"></div>
            <div class="theory mt-5">
                <div class="row">
                    <div class="col-lg-6 col-md-6">
                        <div class="card bg-white text-black">
                            <div class="card-body">
                                <strong>Pixel-level analysis</strong> breaks down images into distinct zones, labeling each pixel based on its content. Our approach leverages this to pinpoint roads in aerial views, supporting tasks like route planning and city development.
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6 col-md-6">
                        <div class="card bg-white text-black">
                            <div class="card-body">
                                Identifying roads from above streamlines aerial data processing, enabling quicker responses during emergencies, smarter urban design, and accurate mapping without manual intervention.
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mt-4">
                    <div class="col-lg-6 col-md-6">
                        <div class="card bg-white text-black">
                            <div class="card-body">
                                Powered by a <strong>U-Net framework</strong>, our system automates road marking, cutting down on the labor-intensive processes found in traditional mapping tools.
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6 col-md-6">
                        <div class="card bg-white text-black">
                            <div class="card-body">
                                Developed using the <strong>MIT Road Dataset</strong>, it highlights roads in yellow over the base image, adapting to diverse areas with adequate training data.
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mt-4 justify-content-center">
                    <div class="col-lg-6 col-md-6 text-center">
                        <div class="image-box">
                            <img src="/static/Images/input.png" alt="Sample Input" class="sample-img">
                        </div>
                    </div>
                    <div class="col-lg-6 col-md-6 text-center">
                        <div class="image-box">
                            <img src="/static/Images/output.png" alt="Sample Output" class="sample-img">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="simulator" id="id-simul">
        <div class="container-fluid">
            <h2>Real-Time Simulator</h2>
            <form id="upload-form" enctype="multipart/form-data" class="text-center">
                <div class="mb-3">
                    <input type="file" class="form-control choose-file" id="image" name="file" accept="image/*" required>
                </div>
                <button type="submit" class="btn simulate-btn">Annotate</button>
            </form>
            <div id="loader" class="loader"></div>
            <div class="row mt-5 justify-content-center">
                <div class="col-lg-6 col-md-8 col-sm-10 result1 text-center">
                    <div class="image-box">
                        <img id="original-image" class="result-img" src="" alt="Original Image">
                    </div>
                    <h3>Input Image</h3>
                </div>
                <div class="col-lg-6 col-md-8 col-sm-10 result2 text-center">
                    <div class="image-box">
                        <img id="annotated-image" class="result-img" src="" alt="Annotated Image">
                    </div>
                    <h3>Annotated Roads</h3>
                </div>
            </div>
        </div>
    </section>

    <section class="about" id="id-about">
        <h2>Developers</h2>
        <div class="row justify-content-center align-items-center">
            <div class="col-md-4 col-sm-6 text-center">
                <h3>Hillol Pratim Kalita</h3>
                <p>4th year CSE<br>Jorhat Engineering College</p>
            </div>
            <div class="col-md-4 col-sm-6 text-center">
                <h3>Rishika Hazarika</h3>
                <p>4th year CSE<br>Jorhat Engineering College</p>
            </div>
        </div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" 
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script>
        document.querySelectorAll('.nav-link').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const targetId = this.getAttribute('href').substring(1);
                const targetElement = document.getElementById(targetId);
                const navbarHeight = document.querySelector('.navbar').offsetHeight;
                const targetPosition = targetElement.getBoundingClientRect().top + window.pageYOffset - navbarHeight;

                window.scrollTo({
                    top: targetPosition,
                    behavior: 'smooth'
                });
            });
        });

        document.getElementById('upload-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const fileInput = document.getElementById('image');
            const formData = new FormData();
            formData.append('file', fileInput.files[0]);
            const loader = document.getElementById('loader');
            const originalImg = document.getElementById('original-image');
            const annotatedImg = document.getElementById('annotated-image');

            loader.style.display = 'block';
            originalImg.classList.remove('show');
            annotatedImg.classList.remove('show');

            try {
                const response = await fetch('/predict/', {
                    method: 'POST',
                    body: formData
                });
                const text = await response.text();
                console.log('Raw response:', text);
                if (!response.ok) {
                    const errorData = JSON.parse(text);
                    throw new Error(errorData.detail || 'Server error');
                }
                const data = JSON.parse(text);
                originalImg.src = data.original;
                annotatedImg.src = data.annotated;
                originalImg.classList.add('show');
                annotatedImg.classList.add('show');
            } catch (error) {
                alert(`Error: ${error.message}`);
            } finally {
                loader.style.display = 'none';
            }
        });
    </script>
</body>
</html>